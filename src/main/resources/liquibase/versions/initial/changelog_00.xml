<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.0.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

	<!-- This initial version includes tables for users, students, teachers, 
		teacher reviews by students -->

	<changeSet id="user_table" author="tillias" context="initial">
		<createTable tableName="user_">
			<column name="id" autoIncrement="true" type="int">
				<constraints primaryKey="true" primaryKeyName="PK_user" />
			</column>
			<column name="first_name" type="varchar(128)">
				<constraints nullable="false" />
			</column>
			<column name="last_name" type="varchar(256)">
				<constraints nullable="false" />
			</column>
			<column name="email" type="varchar(128)">
				<constraints nullable="false" unique="true"
					uniqueConstraintName="UQ_user_email" />
			</column>
			<column name="password" type="varchar(2048)">
				<constraints nullable="false" />
			</column>
			<column name="birthday" type="timestamp">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<changeSet id="student_table" author="tillias" context="initial">
		<createTable tableName="student">
			<column name="id" autoIncrement="true" type="int">
				<constraints primaryKey="true" primaryKeyName="PK_student" />
			</column>
			<column name="user_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_student_user"
					referencedTableName="user_" referencedColumnNames="id" />
			</column>
			<column name="student_no" type="varchar(64)" />
		</createTable>
	</changeSet>

	<changeSet id="teacher_table" author="tillias" context="initial">
		<createTable tableName="teacher">
			<column name="id" autoIncrement="true" type="int">
				<constraints primaryKey="true" primaryKeyName="PK_teacher" />
			</column>
			<column name="user_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_teacher_user"
					referencedTableName="user_" referencedColumnNames="id" />
			</column>
			<column name="experience" type="int" />
		</createTable>
	</changeSet>

	<changeSet id="teacher_review" author="tillias" context="initial">
		<createTable tableName="teacher_review">
			<column name="id" autoIncrement="true" type="int">
				<constraints primaryKey="true" primaryKeyName="PK_teacher_review" />
			</column>
			<column name="student_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_teacher_review_student"
					referencedTableName="student" referencedColumnNames="id" />
			</column>
			<column name="teacher_id" type="int">
				<constraints nullable="false" foreignKeyName="FK_teacher_review_teacher"
					referencedTableName="teacher" referencedColumnNames="id" />
			</column>
			<column name="review_date" type="timestamp">
				<constraints nullable="false"/>
			</column>
			<column name="review_text" type="varchar(4096)">
				<constraints nullable="false"/>
			</column>
			<column name="rating" type="int">
				<constraints nullable="false"/>
			</column>
		</createTable>
	</changeSet>

</databaseChangeLog>