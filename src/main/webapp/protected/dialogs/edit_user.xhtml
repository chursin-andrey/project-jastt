<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:mcv="http://myfaces.apache.org/commons/validators">

<h:head></h:head>

<h:body>
	<ui:composition>
		<p:dialog id="edit_user_dialog" header="Change user account info" widgetVar="editUserDialog" modal="true"
			resizable="false" dynamic="true" maximizable="false" closable="false" closeOnEscape="false">
	    <p:ajax event="close" update="edit_user_dialog" />
	    <h:form id="edit_form">

		<p:messages id="errors" showDetail="false" showSummary="true" autoUpdate="true"
			closable="false" />
        		
        	<h:panelGrid columns="2" style="margin-bottom:10px" cellpadding="5">
        		<p:outputLabel for="editName" value="Name:" />
				<p:inputText id="editName" value="#{usersBean.user.name}" />
					
				<p:outputLabel for="editLogin" value="Login:"/>
				<p:inputText id="editLogin" value="#{usersBean.user.login}"
					required="true"	readonly="true"
					requiredMessage="Login is required" />
						
				<p:outputLabel for="editEmail" value="E-mail:" />
				<p:inputText id="editEmail" value="#{usersBean.user.email}" validator="#{userBean.validateEmail}"
						autocomplete="false">
				</p:inputText>
					
				<p:outputLabel for="editIsAdmin" value="Admin:" />
        		<p:selectBooleanCheckbox id="editIsAdmin" value="#{usersBean.admin}" >
        			<p:ajax update="editLabelUrl, editUrl, editLabelPwd1, editPwd1, editLabelPwd2, editPwd2" />
        		</p:selectBooleanCheckbox>	
        		
        		<p:outputLabel id="editLabelUrl" for="editUrl" value="URL:"/>
				<p:inputText id="editUrl" value="#{usersBean.url}"
					required="#{!usersBean.admin}" requiredMessage="URL is required."
					readonly="#{usersBean.admin}">
					<mcv:validateUrl />
				</p:inputText>
			
				<p:outputLabel id="editLabelPwd1" for="editPwd1" value="Password:" />
        		<p:password id="editPwd1" match="editPwd2" value="#{usersBean.user.password}" 
   					required="true" requiredMessage="Password is required."
   					disabled="false" />
 					
 				<p:outputLabel id="editLabelPwd2" for="editPwd2" value="Password confirmation:" />
        		<p:password id="editPwd2" value="#{usersBean.user.password}"
        			requiredMessage="Password must be confirmed."
        			required="true" disabled="false" />							
					
				<p:commandButton value="Apply" actionListener="#{usersBean.saveUser}"
					update=":edit_form :user_form:usersTable" icon="ui-icon-check"
					oncomplete="if (args &amp;&amp; !args.validationFailed) editUserDialog.hide()" />
				<p:commandButton value="Cancel" actionListener="#{usersBean.cancelHandle}" immediate="true"
					 icon="ui-icon-close" >
				</p:commandButton>   			
			</h:panelGrid>
		</h:form>
		</p:dialog>	
	</ui:composition>
</h:body>
</html>