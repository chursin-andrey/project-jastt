<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:mcv="http://myfaces.apache.org/commons/validators">

<h:head></h:head>

<h:body>
	<ui:composition>
	    <p:dialog id="new_user_dialog" header="Create new user account" widgetVar="newUserDialog" modal="true"
			resizable="false" dynamic="true" maximizable="false" closeOnEscape="false" closable="false">
	    	<h:form id="new_user_form">				
			<p:messages id="error" for="" showSummary="true" showDetail="false"/>
        		<h:panelGrid id="matchGrid" columns="2" style="margin-bottom:10px" cellpadding="5">
        			<p:outputLabel for="addName" value="Name:" />
					<p:inputText id="addName" value="#{userBean.user.name}" />
					
					<p:outputLabel id="addLblLogin" for="addLogin" value="Login:"/>
					<p:inputText id="addLogin" value="#{userBean.user.login}" required="true"
						requiredMessage="Login is required" validator="#{userBean.validateLogin}"
						autocomplete="false">
					</p:inputText>
						
					<p:outputLabel for="addEmail" value="E-mail:" />
					<p:inputText id="addEmail" value="#{userBean.user.email}" validator="#{userBean.validateEmail}"
						autocomplete="false">
					</p:inputText>
					
					<p:outputLabel for="addIsAdmin" value="Admin:" />
        			<p:selectBooleanCheckbox id="addIsAdmin" value="#{userBean.admin}" >
        				<p:ajax update="addLabelUrl, addUrl, addLabelPwd1, addPwd1, addLabelPwd2, addPwd2" />
        			</p:selectBooleanCheckbox>	
        			
        			<p:outputLabel id="addLabelUrl" for="addUrl" value="URL:" />
					<p:inputText id="addUrl" value="#{userBean.url}"
						required="#{!userBean.admin}" disabled="#{userBean.admin}"
						requiredMessage="URL is required.">
						<mcv:validateUrl />
					</p:inputText>
					
					<p:outputLabel id="addLabelPwd1" for="addPwd1" value="Password:" />
        			<p:password id="addPwd1" value="#{userBean.user.password}"
        			 	match="addPwd2" required="true" disabled="false"
        				requiredMessage="Password is required." />	
        				
 					<p:outputLabel id="addLabelPwd2" for="addPwd2" value="Password confirmation:" />
        			<p:password id="addPwd2" value="{userBean.user.password}" 
        				requiredMessage="Password must be confirmed."
        				required="true" disabled="false" />    		

					<p:commandButton value="Save" actionListener="#{userBean.createUser}"
						update=":new_user_form:matchGrid :new_user_form :user_form:usersTable :user_form:growl" icon="ui-icon-check"
						oncomplete="if (args &amp;&amp; !args.validationFailed) newUserDialog.hide()" />
					
					<p:commandButton value="Cancel" actionListener="#{userBean.cancelHandle}" immediate="true"
						icon="ui-icon-close">
					</p:commandButton>
        			   			
				</h:panelGrid>
			</h:form>
		</p:dialog>
		</ui:composition>
	</h:body>
</html>