<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"      
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    template="/templates/commonLayout.xhtml">
    

	<ui:define name="content">
	<h:form id="form">

	<h:panelGrid columns="4" width="1040"  cellspacing="20" >
		<h:column>
	
		<h:outputLabel value="Project:" ><br /><br />
			<h:selectOneMenu id="project" value="#{reportBean.project_name}" style="width:200px;">
			    <f:selectItem itemLabel="Please select a project... " noSelectionOption="true" />
   				<f:selectItems var="project" value="#{reportBean.projects}" itemValue="#{project.name}" itemLabel="#{project.name} " />
   				<f:ajax listener="#{reportBean.changeProject}" render="issue status assignee" />
			</h:selectOneMenu>
		</h:outputLabel>
		<br /><br />
		<h:outputLabel value="Time:" /><br /><br />
		<h:panelGrid columns="2" width="250" cellspacing="0">
			<h:column style="height:200;">
				<h:selectOneRadio value="#{reportBean.timespent}" style="height:200;" layout="pageDirection">
   					<f:selectItem itemValue="allTime" style="margin-bottom:10px;" itemLabel=""  /> 
   					<f:selectItem itemValue="date" itemLabel="" />
   					<f:ajax listener="#{reportBean.changeTime}" render="issue allTime dateFrom dateTo" />
				</h:selectOneRadio>
				
			</h:column>
			<h:column>
				<h:selectOneMenu id="allTime" value="#{reportBean.timespent}" disabled="#{reportBean.disableSelectTime}" style="width:200px;" >
   					<f:selectItem itemLabel="AllTime" noSelectionOption="true" />
				</h:selectOneMenu>
				<br /><br />
				 <p:outputLabel value="from: " />
       			 <p:calendar id="dateFrom" size="5" style="font-size:11px;" value="#{reportBean.dateFrom}" disabled="#{reportBean.disableSelectDate}"/>
 				  <p:outputLabel value=" to: " />
       			 <p:calendar id="dateTo" size="5" style="font-size:11px;" value="#{reportBean.dateTo}" disabled="#{reportBean.disableSelectDate}" />
			</h:column>
		</h:panelGrid>
		
			
		
		</h:column>
		<h:column>
			<h:outputLabel value="Task:" ><br /><br />
			<h:selectOneMenu id="issue"  value="#{reportBean.issueType}" disabled="#{reportBean.disableMenu}" style="width:200px;">
				<f:selectItem itemLabel="All " noSelectionOption="true" />
   				<f:selectItem itemValue="Bug" itemLabel="Bug" />
   				<f:selectItem itemValue="Improvement" itemLabel="Improvement" />
   				<f:selectItem itemValue="New feature" itemLabel="New feature" />
   				<f:selectItem itemValue="Task" itemLabel="Task" />
			<f:ajax listener="#{reportBean.changeIssue}" render="assignee" />
			</h:selectOneMenu>
			</h:outputLabel>
			<br /><br />
			<h:outputLabel value="Status:" ><br /><br />
				<h:selectOneMenu id="status"  value="#{reportBean.status}" onchange="submit" immediate="true" disabled="#{reportBean.disableMenu}" style="width:200px;">
					<f:selectItem itemLabel="All " noSelectionOption="true" />
					<f:selectItem itemValue="Open" itemLabel="Open" />
					<f:selectItem itemValue="In progress" itemLabel="In progress" />
					<f:selectItem itemValue="Resolved" itemLabel="Resolved" />
					<f:selectItem itemValue="Reopened" itemLabel="Reopened" />
					<f:selectItem itemValue="Closed" itemLabel="Closed" />
				</h:selectOneMenu>
			</h:outputLabel> <br /><br /><br />
		</h:column>
		<h:column>
		<h:outputLabel value="Member:" ><br /><br />
			<h:selectOneMenu id="assignee"  value="#{reportBean.assignee_id}" disabled="#{reportBean.disableMenu}" converter="javax.faces.Integer" style="width:200px;">
				<f:selectItem itemLabel="All " noSelectionOption="true" />
   				<f:selectItems var="assignee" value="#{reportBean.assignees}" itemValue="#{assignee.id} " itemLabel="#{assignee.name} " />
   				<f:ajax listener="#{reportBean.changeAssignee}" render="issue" />
			</h:selectOneMenu>
		</h:outputLabel>
		<br /><br />
		<h:outputLabel value="Members:" ><br /><br />
		  	<p:selectCheckboxMenu id="assignees" value="#{reportBean.assignees_name}" label="Members"
                              filter="true" filterMatchMode="startsWith" panelStyle="width:250px">
            	<f:selectItems var="assignee" value="#{reportBean.assignees}" itemValue="#{assignee.name} " itemLabel="#{assignee.name} " />
        	</p:selectCheckboxMenu>
		</h:outputLabel> <br /><br /><br />
		</h:column>
		<h:column>
		<br />
			
			<br /><br /><br /><br />
			<h:commandButton value="Clear" update="project issue status assignee" action="#{reportBean.clearReport()}" style="width:150px;"/>
			<br /><br />
		</h:column>
	</h:panelGrid>
	



		

	<h:panelGrid columns="3" width="400"  cellspacing="20">
	<h:commandButton value="Show" update="Report Details" action="#{reportBean.showReport()}" style="width:100px;"/>
	<h:commandButton value="Cancel" action="#{reportBean.cancelAction()}" style="width:100px;"/>
	<h:commandButton value="Update" action="#{reportBean.updateData()}" style="width:100px;"/>
	</h:panelGrid>
	
	
		<p:tabView activeIndex="0">
			<p:tab title="Details">
					<p:dataTable var="details" value="#{reportBean.reportIssues}" id="Details" lazy="true">
						<f:facet name="header">Total Elapsed Time              
    						<p:column datasource="Details" trigger="toggler"/>
                			<p:outputPanel>
                				<h:outputText value="hours:"/> 
		        				<p:inputText id="globalFilter1" onkeyup="PF('Details').filter()" style="width:250px" placeholder="hours"/>
                    			<h:outputText value="	minuts:"/>
                    			<p:inputText id="globalFilter2" onkeyup="PF('Detailse').filter()" style="width:250px" placeholder="minuts"/>
                			</p:outputPanel>            
            			</f:facet>
            			<p:column headerText="Date">
            				<h:outputText  value="#{details.created}"  />
            			</p:column>
						<p:column headerText="Member">
							<h:outputText  value="#{details.assignee.name}"  />
               			</p:column>
						<p:column headerText="Project">
							<h:outputText  value="#{details.project.name}"  />
						</p:column>
						<p:column headerText="Task">
							<h:outputText  value="#{details.issueType}"  />
						</p:column>
						<p:column headerText="Status">
						 <h:outputText  value="#{details.status}"  />
						</p:column>
						<p:column headerText="Summary">
							<h:outputText  value="#{details.summary}"  />
						</p:column>
						<p:column headerText="Hours">
							<h:outputText  value="#{details.timeSpent}"  />
						</p:column>
					</p:dataTable>
			</p:tab>
        	<p:tab title="Report">   
					<p:dataTable var="report" value="#{reportBean.reportIssues}" id="Report" lazy="true">
						<f:facet name="header">Total Elapsed Time              
                			<p:column datasource="Report" trigger="toggler"/>
               				<p:outputPanel>
                    			<h:outputText value="hours:"/> 
                    			<p:inputText id="globalFilter1" onkeyup="PF('Report').filter()" style="width:250px" placeholder="hours"/>
                    			<h:outputText value="	minuts:"/>
                    			<p:inputText id="globalFilter2" onkeyup="PF('Report').filter()" style="width:250px" placeholder="minuts"/>
                			</p:outputPanel>
                		</f:facet>
						<p:column headerText="Member">
							<h:outputText  value="#{report.assignee.name}"  />
               			 </p:column>
						<p:column headerText="Project">
							<h:outputText  value="#{report.project.name}"  />
               			 </p:column>
						<p:column headerText="Task">
						<p:dataTable var="task" value="#{reportBean.reportIssues}" id="Report" lazy="true">
						
						</p:dataTable>
							<h:outputText  value="#{report.issueType}"  />
						</p:column>
						<p:column headerText="Hours">
							<h:outputText  value="#{report.timeSpent}"  />
						</p:column>
					</p:dataTable>
					<br/>
					
					<h:panelGrid columns="3" width="250">
					<h:commandButton value="Export to PDF" actionListener="#{reportBean.exportToPDF}"/>
					<h:commandButton value="Export to Xls" actionListener="#{reportBean.exportToXls}"/>
					<h:commandButton value="Export to Xlsx" actionListener="#{reportBean.exportToXlsx}"/>
					</h:panelGrid>
        	</p:tab>
    	</p:tabView>    		
</h:form>
	</ui:define>
</ui:composition>    